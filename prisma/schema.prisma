generator client {
  provider = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}

model Account {
    id  Int @id @default(autoincrement())
    address String
    contracts Contract[] // list of contracts deployed to the account
}

model Contract {
    id  Int @id @default(autoincrement())
    name String // name of the contract

    // Contract is related to specific account
    accountId Int
    account Account @relation(fields: [accountId], references: [id])

    code ContractCode[]
    tags Tag[]

    interactions Int @default(0) // number of interactions, we can read this from FlowGraph
}

model ContractCode {
    id Int @id @default(autoincrement())

    // Code is related to specific Contract
    contract Contract @relation(fields: [contractId], references: [id])
    contractId Int // @relation attribute

    comments Comment[]
    lastUpdated DateTime?
    cadence String
}

model Comment {
    id  Int @id @default(autoincrement())

    // Code is related to specific Contract
    contract Contract @relation(fields: [contractId], references: [id])
    contractId Int // @relation attribute

    lineStart Int
    lineEnd Int
    content String
}

model Tag {
    id  Int @id @default(autoincrement())
    name String
}